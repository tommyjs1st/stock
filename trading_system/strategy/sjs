    @staticmethod
    def calculate_ma5_divergence(df, price_column='stck_prpr'):
        """
        5일 이동평균선과의 이격도 계산
        
        Args:
            df: 주가 데이터프레임
            price_column: 가격 컬럼명
        
        Returns:
            pandas.Series: 이격도 비율 (%)
        """
        try:
            if df.empty or len(df) < 5:
                return pd.Series(dtype=float)
            
            df = df.copy()
            df['ma5'] = df[price_column].rolling(window=5).mean()
            
            # 이격도 = (현재가 / 5일선) * 100
            divergence = (df[price_column] / df['ma5']) * 100
            
            return divergence
            
        except Exception as e:
            logger.error(f"❌ 5일선 이격도 계산 오류: {e}")
            return pd.Series(dtype=float)
