# ë°ì´í„° ìˆ˜ì§‘ ìƒíƒœ í™•ì¸ ê°€ì´ë“œ

## ê°œìš”
`check_collection_status.py`ëŠ” `daily_collector.py`ì™€ `minute_collector.py`ë¡œ ìˆ˜ì§‘í•œ ë°ì´í„°ê°€ ì œëŒ€ë¡œ DBì— ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤.

## ê¸°ëŠ¥

### 1. ì¼ë´‰ ë°ì´í„° í™•ì¸ (daily_stock_prices í…Œì´ë¸”)
- âœ… ì´ ì¢…ëª© ìˆ˜ ë° ë ˆì½”ë“œ ìˆ˜
- âœ… ë°ì´í„° ê¸°ê°„ (ìµœì†Œ/ìµœëŒ€ ë‚ ì§œ)
- âœ… ì˜¤ëŠ˜ ìˆ˜ì§‘ëœ ë°ì´í„° ìˆ˜
- âœ… ìµœê·¼ 7ì¼ ìˆ˜ì§‘ í˜„í™© (ë‚ ì§œë³„ ì¢…ëª© ìˆ˜)
- âœ… ë°ì´í„° ë³´ìœ ëŸ‰ TOP 10 ì¢…ëª©

### 2. ë¶„ë´‰ ë°ì´í„° í™•ì¸ (minute_stock_prices í…Œì´ë¸”)
- âœ… ì´ ì¢…ëª© ìˆ˜ ë° ë ˆì½”ë“œ ìˆ˜
- âœ… ë°ì´í„° ê¸°ê°„ (ìµœì†Œ/ìµœëŒ€ ì‹œê°„)
- âœ… ì˜¤ëŠ˜ ìˆ˜ì§‘ëœ ë°ì´í„° ìˆ˜
- âœ… ìµœê·¼ 1ì‹œê°„ ìˆ˜ì§‘ ë°ì´í„° ìˆ˜
- âœ… ì˜¤ëŠ˜ ìˆ˜ì§‘ TOP 10 ì¢…ëª©

### 3. ë°°ì¹˜ ì‹¤í–‰ ì´ë ¥ (batch_history í…Œì´ë¸”)
- âœ… ìµœê·¼ 10ê±´ì˜ ë°°ì¹˜ ì‹¤í–‰ ê¸°ë¡
- âœ… ì„±ê³µ/ì‹¤íŒ¨ í†µê³„
- âœ… ì†Œìš” ì‹œê°„

### 4. ë°ì´í„° í’ˆì§ˆ ì²´í¬
- âœ… ì˜ëª»ëœ ê°€ê²© ë°ì´í„° (0 ë˜ëŠ” NULL)
- âœ… ê±°ë˜ëŸ‰ì´ 0ì¸ ë ˆì½”ë“œ (ê³µíœ´ì¼/íœ´ì¥ì¼ ê°€ëŠ¥)

### 5. íŠ¹ì • ì¢…ëª© ìƒì„¸ ì¡°íšŒ
- âœ… ì¢…ëª© ì •ë³´ (ì¢…ëª©ëª…, ì‹œê°€ì´ì•¡)
- âœ… ì¼ë´‰ ë°ì´í„° í†µê³„ (ë ˆì½”ë“œ ìˆ˜, ê¸°ê°„)
- âœ… ë¶„ë´‰ ë°ì´í„° í†µê³„ (ìµœê·¼ 7ì¼)

## ì‚¬ìš©ë²•

### ğŸš€ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (ê¶Œì¥)

ê°€ì¥ ê°„í¸í•œ ë°©ë²•ì…ë‹ˆë‹¤!

```bash
# ëŒ€í™”í˜• ë©”ë‰´ ì‹¤í–‰
./check_status.sh

# ì§ì ‘ ì˜µì…˜ ì§€ì •
./check_status.sh --daily         # ì¼ë´‰ë§Œ
./check_status.sh --minute        # ë¶„ë´‰ë§Œ
./check_status.sh --detailed      # ìƒì„¸ ë¦¬í¬íŠ¸
./check_status.sh --stock 005930  # íŠ¹ì • ì¢…ëª©
```

### ê¸°ë³¸ ì‚¬ìš©ë²• (ì „ì²´ í˜„í™© í™•ì¸)
```bash
python check_collection_status.py
```

ì¶œë ¥ ë‚´ìš©:
- ì¼ë´‰ ë°ì´í„° í˜„í™©
- ë¶„ë´‰ ë°ì´í„° í˜„í™©
- ë°°ì¹˜ ì‹¤í–‰ ì´ë ¥

### ì¼ë´‰ ë°ì´í„°ë§Œ í™•ì¸
```bash
python check_collection_status.py --daily
```

### ë¶„ë´‰ ë°ì´í„°ë§Œ í™•ì¸
```bash
python check_collection_status.py --minute
```

### ìƒì„¸ ë¦¬í¬íŠ¸ (ë°ì´í„° í’ˆì§ˆ í¬í•¨)
```bash
python check_collection_status.py --detailed
```

ì¶”ê°€ ì¶œë ¥ ë‚´ìš©:
- ë°ì´í„° í’ˆì§ˆ ì²´í¬ ê²°ê³¼

### ì¼ë´‰ + ìƒì„¸ ë¦¬í¬íŠ¸
```bash
python check_collection_status.py --daily --detailed
```

### íŠ¹ì • ì¢…ëª© ìƒì„¸ ì¡°íšŒ
```bash
# ì‚¼ì„±ì „ì (005930) ì¡°íšŒ
python check_collection_status.py --stock 005930

# SKí•˜ì´ë‹‰ìŠ¤ (000660) ì¡°íšŒ
python check_collection_status.py --stock 000660
```

## ì¶œë ¥ ì˜ˆì‹œ

### ì „ì²´ í˜„í™© ë¦¬í¬íŠ¸
```
================================================================================
ğŸ“ˆ ë°ì´í„° ìˆ˜ì§‘ ìƒíƒœ ì ê²€ ë¦¬í¬íŠ¸
ìƒì„± ì‹œê°„: 2026-02-09 21:08:08
================================================================================

================================================================================
ğŸ“Š ì¼ë´‰ ë°ì´í„° ìˆ˜ì§‘ í˜„í™©
================================================================================

âœ… ì „ì²´ í†µê³„:
   - ì´ ì¢…ëª© ìˆ˜: 409ê°œ
   - ì´ ë ˆì½”ë“œ ìˆ˜: 133,807ê±´
   - ë°ì´í„° ê¸°ê°„: 2024-09-19 ~ 2026-02-09
   - ì˜¤ëŠ˜ ìˆ˜ì§‘: 140ê±´
   - ìµœê·¼ 7ì¼ ìˆ˜ì§‘: 2,173ê±´

ğŸ“… ìµœê·¼ 7ì¼ ìˆ˜ì§‘ í˜„í™©:
   âœ… 2026-02-09 (ì›”): 140ê°œ ì¢…ëª©
   âœ… 2026-02-06 (ê¸ˆ): 400ê°œ ì¢…ëª©
   âœ… 2026-02-05 (ëª©): 406ê°œ ì¢…ëª©
   ...

ğŸ† ë°ì´í„° ë³´ìœ  TOP 10 ì¢…ëª©:
    1. ì‚¼ì„±ì¤‘ê³µì—…(010140): 338ê±´ (2024-09-19 ~ 2026-02-09)
    2. HDí˜„ëŒ€(267250): 338ê±´ (2024-09-19 ~ 2026-02-09)
    ...
```

### íŠ¹ì • ì¢…ëª© ì¡°íšŒ
```
================================================================================
ğŸ” ì¢…ëª© ìƒì„¸ ì •ë³´: 005930
================================================================================

ì¢…ëª©ëª…: ì‚¼ì„±ì „ì
ì‹œê°€ì´ì•¡: N/A
ìµœì¢… ì—…ë°ì´íŠ¸: 2026-02-09 21:00:18

ğŸ“Š ì¼ë´‰ ë°ì´í„°:
   - ë ˆì½”ë“œ ìˆ˜: 338ê±´
   - ê¸°ê°„: 2024-09-19 ~ 2026-02-09

â±ï¸  ë¶„ë´‰ ë°ì´í„° (ìµœê·¼ 7ì¼):
   - ë ˆì½”ë“œ ìˆ˜: 1,234ê±´
   - ê¸°ê°„: 2026-02-03 09:00:00 ~ 2026-02-09 15:30:00
   - ì˜¤ëŠ˜ ìˆ˜ì§‘: 378ê±´
```

## ë°ì´í„° í’ˆì§ˆ ì²´í¬ í•­ëª©

### ì¼ë´‰ ë°ì´í„°
- **ì˜ëª»ëœ ê°€ê²©**: ì¢…ê°€(close_price)ê°€ 0ì´ê±°ë‚˜ NULLì¸ ë ˆì½”ë“œ
- **ê±°ë˜ëŸ‰ 0**: ê³µíœ´ì¼ì´ë‚˜ íœ´ì¥ì¼ì— ë°œìƒ ê°€ëŠ¥

### ë¶„ë´‰ ë°ì´í„°
- **ì˜ëª»ëœ ê°€ê²©**: ì¢…ê°€(close_price)ê°€ 0ì´ê±°ë‚˜ NULLì¸ ë ˆì½”ë“œ
- **ê±°ë˜ëŸ‰ 0**: ì¥ ë§ˆê° í›„ë‚˜ ì²´ê²°ì´ ì—†ëŠ” ì‹œê°„ì— ë°œìƒ ê°€ëŠ¥

## í™œìš© ì‹œë‚˜ë¦¬ì˜¤

### 1. ë§¤ì¼ ë°°ì¹˜ ì‹¤í–‰ í›„ í™•ì¸
```bash
# daily_collector ì‹¤í–‰ í›„
python check_collection_status.py --daily

# ì˜¤ëŠ˜ ìˆ˜ì§‘ëœ ë°ì´í„° ê°œìˆ˜ í™•ì¸
# ìµœê·¼ 7ì¼ íŠ¸ë Œë“œ í™•ì¸
```

### 2. ë¶„ë´‰ ìˆ˜ì§‘ í›„ í™•ì¸
```bash
# minute_collector ì‹¤í–‰ í›„
python check_collection_status.py --minute

# ì˜¤ëŠ˜ ìˆ˜ì§‘ëœ ë¶„ë´‰ ë°ì´í„° í™•ì¸
# ë³´ìœ ì¢…ëª©ë³„ ìˆ˜ì§‘ í˜„í™© í™•ì¸
```

### 3. ë°ì´í„° í’ˆì§ˆ ì ê²€
```bash
# ì£¼ê¸°ì ìœ¼ë¡œ ë°ì´í„° í’ˆì§ˆ ì²´í¬
python check_collection_status.py --detailed

# ì˜ëª»ëœ ë°ì´í„° í™•ì¸
# ëˆ„ë½ ë°ì´í„° í™•ì¸
```

### 4. íŠ¹ì • ì¢…ëª© ë””ë²„ê¹…
```bash
# íŠ¹ì • ì¢…ëª©ì˜ ë°ì´í„° ìˆ˜ì§‘ ìƒíƒœ í™•ì¸
python check_collection_status.py --stock 005930

# ì¼ë´‰/ë¶„ë´‰ ë°ì´í„° ëª¨ë‘ í™•ì¸
# ìˆ˜ì§‘ ê¸°ê°„ í™•ì¸
```

### 5. ë°°ì¹˜ ì´ë ¥ í™•ì¸
```bash
# ë°°ì¹˜ ì‹¤í–‰ ì„±ê³µ/ì‹¤íŒ¨ í™•ì¸
python check_collection_status.py

# ìµœê·¼ 10ê±´ì˜ ë°°ì¹˜ ì´ë ¥ í™•ì¸
# ì†Œìš” ì‹œê°„ í™•ì¸
```

## ìë™í™” ì˜ˆì‹œ

### cron ìŠ¤ì¼€ì¤„ë§
```bash
# ë§¤ì¼ ë°¤ 9ì‹œì— ì¼ë´‰ ìˆ˜ì§‘ í›„ í™•ì¸
0 21 * * 1-5 cd /Users/jsshin/RESTAPI/analyze && python daily_collector.py --daily && python check_collection_status.py --daily > logs/daily_check_$(date +\%Y\%m\%d).log

# ë§¤ ì‹œê°„ë§ˆë‹¤ ë¶„ë´‰ ìˆ˜ì§‘ í›„ í™•ì¸
0 * * * 1-5 cd /Users/jsshin/RESTAPI/analyze && python minute_collector.py && python check_collection_status.py --minute
```

### ì‰˜ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# check_daily_collection.sh

cd /Users/jsshin/RESTAPI/analyze

echo "ì¼ë´‰ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘..."
python daily_collector.py --daily

echo "ìˆ˜ì§‘ ê²°ê³¼ í™•ì¸..."
python check_collection_status.py --daily --detailed

echo "ì™„ë£Œ!"
```

## ë¬¸ì œ í•´ê²°

### ë°ì´í„°ê°€ ìˆ˜ì§‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°
1. `batch_history` í…Œì´ë¸”ì—ì„œ ë°°ì¹˜ ì‹¤í–‰ ê¸°ë¡ í™•ì¸
2. ë¡œê·¸ íŒŒì¼ í™•ì¸: `logs/daily_batch_YYYYMMDD.log` ë˜ëŠ” `logs/minute_collector_YYYYMMDD.log`
3. DB ì—°ê²° ìƒíƒœ í™•ì¸
4. API í† í° ë§Œë£Œ ì—¬ë¶€ í™•ì¸

### ë°ì´í„° í’ˆì§ˆ ë¬¸ì œê°€ ë°œê²¬ëœ ê²½ìš°
1. `--detailed` ì˜µì…˜ìœ¼ë¡œ ìƒì„¸ í’ˆì§ˆ ì²´í¬
2. íŠ¹ì • ì¢…ëª©ì˜ ë°ì´í„° í™•ì¸: `--stock <ì¢…ëª©ì½”ë“œ>`
3. ì›ë³¸ ë°ì´í„° ìˆ˜ì§‘ê¸° ë¡œê·¸ í™•ì¸
4. í•„ìš”ì‹œ í•´ë‹¹ ì¢…ëª© ì¬ìˆ˜ì§‘

### ë¶„ë´‰ ë°ì´í„°ê°€ ë„ˆë¬´ ë§ì€ ê²½ìš°
```bash
# 30ì¼ ì´ì „ ë¶„ë´‰ ë°ì´í„° ì •ë¦¬
python minute_collector.py --cleanup --days 30 -y
```

## ì°¸ê³ 

- `daily_collector.py`: ì¼ë´‰ ë°ì´í„° ìˆ˜ì§‘ í”„ë¡œê·¸ë¨
- `minute_collector.py`: ë¶„ë´‰ ë°ì´í„° ìˆ˜ì§‘ í”„ë¡œê·¸ë¨
- `config.yaml`: DB ì—°ê²° ì„¤ì • íŒŒì¼
- `db_manager.py`: DB ê´€ë¦¬ ëª¨ë“ˆ

## ì¶”ê°€ ì •ë³´

### DB í…Œì´ë¸” êµ¬ì¡° í™•ì¸
```bash
python check_db_structure.py
```

### ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜
- ì¼ë´‰ ìˆ˜ì§‘: `logs/daily_batch_YYYYMMDD.log`
- ë¶„ë´‰ ìˆ˜ì§‘: `logs/minute_collector_YYYYMMDD.log`
